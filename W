pcall(function()

if not game.Players.LocalPlayer.Character or game.Players.LocalPlayer.Character:WaitForChild("Humanoid").RigType ~= Enum.HumanoidRigType.R15 then 
    game.StarterGui:SetCore("SendNotification", {Title = "R6", Text = "You're on R6, bro. Change to R15!", Duration = 60})
    return
end

local st = os.clock()
local TweenService = game:GetService("TweenService")
local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")
local camera = workspace.CurrentCamera

cloneref = cloneref or function(o) return o end
local GazeGoGui = cloneref(game:GetService("CoreGui")) or game:GetService("CoreGui") or game.Players.LocalPlayer:WaitForChild("PlayerGui")

local Notifbro = {}
function Notify(titletxt, text, time)
    coroutine.wrap(function()
        local GUI = Instance.new("ScreenGui")
        local Main = Instance.new("Frame", GUI)
        local title = Instance.new("TextLabel", Main)
        local message = Instance.new("TextLabel", Main)

        GUI.Name = "BackgroundNotif"
        GUI.Parent = GazeGoGui

        local sw = workspace.CurrentCamera.ViewportSize.X
        local sh = workspace.CurrentCamera.ViewportSize.Y
        local nh = sh / 7
        local nw = sw / 5

        Main.Name = "MainFrame"
        Main.BackgroundColor3 = Color3.new(0.156863, 0.156863, 0.156863)
        Main.BackgroundTransparency = 0.2
        Main.BorderSizePixel = 0
        Main.Size = UDim2.new(0, nw, 0, nh)

        title.BackgroundColor3 = Color3.new(0, 0, 0)
        title.BackgroundTransparency = 0.9
        title.Size = UDim2.new(1, 0, 0, nh / 2)
        title.Font = Enum.Font.GothamBold
        title.Text = titletxt
        title.TextColor3 = Color3.new(1, 1, 1)
        title.TextScaled = true

        message.BackgroundColor3 = Color3.new(0, 0, 0)
        message.BackgroundTransparency = 1
        message.Position = UDim2.new(0, 0, 0, nh / 2)
        message.Size = UDim2.new(1, 0, 1, -nh / 2)
        message.Font = Enum.Font.Gotham
        message.Text = text
        message.TextColor3 = Color3.new(1, 1, 1)
        message.TextScaled = true

        local offset = 50
        for _, notif in ipairs(Notifbro) do
            offset = offset + notif.Size.Y.Offset + 10
        end

        Main.Position = UDim2.new(1, 5, 0, offset)
        table.insert(Notifbro, Main)

        task.wait(0.1)
        Main:TweenPosition(UDim2.new(1, -nw, 0, offset), Enum.EasingDirection.Out, Enum.EasingStyle.Bounce, 0.5, true)
        Main:TweenSize(UDim2.new(0, nw * 1.06, 0, nh * 1.06), Enum.EasingDirection.Out, Enum.EasingStyle.Elastic, 0.5, true)
        task.wait(0.1)
        Main:TweenSize(UDim2.new(0, nw, 0, nh), Enum.EasingDirection.Out, Enum.EasingStyle.Elastic, 0.2, true)

        task.wait(time)

        Main:TweenSize(UDim2.new(0, nw * 1.06, 0, nh * 1.06), Enum.EasingDirection.In, Enum.EasingStyle.Elastic, 0.2, true)
        task.wait(0.2)
        Main:TweenSize(UDim2.new(0, nw, 0, nh), Enum.EasingDirection.In, Enum.EasingStyle.Elastic, 0.2, true)
        task.wait(0.2)
        Main:TweenPosition(UDim2.new(1, 5, 0, offset), Enum.EasingDirection.In, Enum.EasingStyle.Bounce, 0.5, true)
        task.wait(0.1)

        GUI:Destroy()
        for i, notif in ipairs(Notifbro) do
            if notif == Main then
                table.remove(Notifbro, i)
                break
            end
        end

        for i, notif in ipairs(Notifbro) do
            local newOffset = 50 + (nh + 10) * (i - 1)
            notif:TweenPosition(UDim2.new(1, -nw, 0, newOffset), Enum.EasingDirection.Out, Enum.EasingStyle.Bounce, 0.5, true)
        end
    end)()
end

task.wait(0.1)

local guiName = "GazeVerificator"
if GazeGoGui:FindFirstChild(guiName) then
    Notify("Error","Script Already Executed", 1)
    return
end

local function getScaledSize(relativeWidth, relativeHeight)
    local viewportSize = camera.ViewportSize
    return UDim2.new(0, math.floor(viewportSize.X * relativeWidth), 0, math.floor(viewportSize.Y * relativeHeight))
end

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "DraggableGui"
screenGui.Parent = cloneref(game.CoreGui)

local frame = Instance.new("TextButton")
frame.Name = "GazeBro"
frame.Text = ""
frame.Size = getScaledSize(0.3, 0.4) 
frame.Position = UDim2.new(0.5, -getScaledSize(0.3,0.4).X.Offset / 2, 0.5, -getScaledSize(0.3,0.4).Y.Offset / 2)
frame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
frame.BackgroundTransparency = 0.2
frame.BorderSizePixel = 2
frame.BorderColor3 = Color3.new(0, 0, 0)
frame.Active = true
frame.Draggable = true
frame.Parent = screenGui

local labelSize = UDim2.new(1, 0, 0.1, 0)

local gazeLabel = Instance.new("TextLabel")
gazeLabel.Name = "GazeLabel"
gazeLabel.Text = "GAZE"
gazeLabel.Font = Enum.Font.SourceSansBold
gazeLabel.TextScaled = true
gazeLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
gazeLabel.BackgroundTransparency = 1
gazeLabel.Size = labelSize
gazeLabel.Position = UDim2.new(0, 0, 0, 0)
gazeLabel.Parent = frame

local searchBar = Instance.new("TextBox")
searchBar.Name = "SearchBar"
searchBar.Text = ""
searchBar.PlaceholderText = "Search..."
searchBar.Font = Enum.Font.SourceSans
searchBar.TextScaled = true
searchBar.TextColor3 = Color3.fromRGB(200, 200, 200)
searchBar.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
searchBar.BorderSizePixel = 0
searchBar.Size = UDim2.new(0.9, 0, 0.2, 0)
searchBar.Position = UDim2.new(0.05, 0, 0.10, 0)
searchBar.ClearTextOnFocus = true
searchBar.Parent = frame

local scrollFrame = Instance.new("ScrollingFrame")
scrollFrame.Name = "ScrollFrame"
scrollFrame.Size = UDim2.new(0.9, 0, 0.7, 0)
scrollFrame.Position = UDim2.new(0.05, 0, 0.3, 0)
scrollFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
scrollFrame.BorderSizePixel = 0
scrollFrame.ScrollBarThickness = 5
scrollFrame.ScrollingDirection = Enum.ScrollingDirection.Y
scrollFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
scrollFrame.Parent = frame

local buttons = {}
local createdSet = {}

local function createTheButton(text, callback)
    if createdSet[text] then
        return
    end
    createdSet[text] = true

    local button = Instance.new("TextButton")
    button.Text = text
    button.Font = Enum.Font.SourceSansBold
    button.TextScaled = true
    button.TextColor3 = Color3.fromRGB(255, 255, 255)
    button.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
    button.Size = UDim2.new(1, 0, 0, 40)
    button.Position = UDim2.new(0, 0, 0, #buttons * 45)
    button.BorderSizePixel = 0
    button.Parent = scrollFrame

    button.MouseButton1Click:Connect(function()
        pcall(callback)
    end)

    table.insert(buttons, button)
    scrollFrame.CanvasSize = UDim2.new(0, 0, 0, #buttons * 45)
end

searchBar:GetPropertyChangedSignal("Text"):Connect(function()
    local searchText = searchBar.Text:lower()
    local order = 0
    for _, button in ipairs(buttons) do
        if searchText == "" or button.Text:lower():find(searchText) then
            button.Visible = true
            button.Position = UDim2.new(0, 0, 0, order * 45)
            order += 1
        else
            button.Visible = false
        end
    end
    scrollFrame.CanvasSize = UDim2.new(0, 0, 0, order * 45)
end)

-- [ALL ANIMATIONS WOULD GO HERE - SAME AS BEFORE]
local OriginalAnimations = {
    ["Idle"] = {
        ["2016 Animation (mm2)"] = {"387947158", "387947464"},
        -- ... [ALL THE ORIGINAL ANIMATIONS]
    },
    ["Walk"] = {
        ["Gojo"] = "95643163365384",
        -- ... [ALL THE ORIGINAL ANIMATIONS]
    },
    ["Run"] = {
        ["2016 Animation (mm2)"] = "387947975",
        -- ... [ALL THE ORIGINAL ANIMATIONS]
    },
    ["Jump"] = {
        ["Astronaut"] = "891627522",
        -- ... [ALL THE ORIGINAL ANIMATIONS]
    },
    ["Fall"] = {
        ["Astronaut"] = "891617961",
        -- ... [ALL THE ORIGINAL ANIMATIONS]
    },
    ["SwimIdle"] = {
        ["Astronaut"] = "891663592",
        -- ... [ALL THE ORIGINAL ANIMATIONS]
    },
    ["Swim"] = {
        ["Astronaut"] = "891663592",
        -- ... [ALL THE ORIGINAL ANIMATIONS]
    },
    ["Climb"] = {
        ["Astronaut"] = "10921032124",
        -- ... [ALL THE ORIGINAL ANIMATIONS]
    }
}

local Animations
if isfile("GreyLikesToSmellUrFeet.json") then
    local data = readfile("GreyLikesToSmellUrFeet.json")
    Animations = HttpService:JSONDecode(data)
    Notify("Loaded", "Animations from GreyLikesToSmellUrFeet.json", 3)
else
    writefile("GreyLikesToSmellUrFeet.json", HttpService:JSONEncode(OriginalAnimations))
    Animations = OriginalAnimations
    Notify("Saved", "Original animations to GreyLikesToSmellUrFeet.json", 3)
end

-- Last animations storage for respawn persistence
local lastAnimations = {}

-- Save last animations to file
local function saveLastAnimations()
    local data = HttpService:JSONEncode(lastAnimations)
    pcall(function() 
        writefile("LastAnimations.json", data) 
    end)
end

-- Load last animations from file
local function loadLastAnimations()
    if isfile("LastAnimations.json") then
        local data = readfile("LastAnimations.json")
        lastAnimations = HttpService:JSONDecode(data)
        Notify("Loaded", "Saved animations found", 3)
    else
        Notify("Info", "No saved animations found", 3)
    end
end

-- FIXED: Freeze/Unfreeze system from original script
local function freeze()
    local player = cloneref(game:GetService("Players")).LocalPlayer
    local character = player.Character or player.CharacterAdded:Wait()
    local humanoid = character:WaitForChild("Humanoid")
    humanoid.PlatformStand = true
    if player and player.Character then
        task.spawn(function()
            for i, part in ipairs(player.Character:GetDescendants()) do
                if part:IsA("BasePart") and not part.Anchored then
                    part.Anchored = true
                end
            end
        end)
    end
end

local function unfreeze()
    local player = cloneref(game:GetService("Players")).LocalPlayer
    local character = player.Character or player.CharacterAdded:Wait()
    local humanoid = character:WaitForChild("Humanoid")
    humanoid.PlatformStand = false
    if player and player.Character then
        task.spawn(function()
            for i, part in ipairs(player.Character:GetDescendants()) do
                if part:IsA("BasePart") and part.Anchored then
                    part.Anchored = false
                end
            end
        end)
    end
end

-- FIXED: setAnimation with freeze/unfreeze system
local function setAnimation(animationType, animationId)
    local player = Players.LocalPlayer
    if not player.Character then 
        Notify("Error", "No character found", 2)
        return 
    end
    
    local Char = player.Character
    local Animate = Char:FindFirstChild("Animate")
    if not Animate then 
        Notify("Error", "Animate script not found", 2)
        return 
    end

    -- Freeze character to force animation refresh
    freeze()
    task.wait(0.1)

    local success, err = pcall(function()
        if animationType == "Idle" then
            lastAnimations.Idle = animationId
            Animate.idle.Animation1.AnimationId = "rbxassetid://" .. animationId[1]
            Animate.idle.Animation2.AnimationId = "rbxassetid://" .. animationId[2]
        elseif animationType == "Walk" then
            lastAnimations.Walk = animationId
            Animate.walk.WalkAnim.AnimationId = "rbxassetid://" .. animationId
        elseif animationType == "Run" then
            lastAnimations.Run = animationId
            Animate.run.RunAnim.AnimationId = "rbxassetid://" .. animationId
        elseif animationType == "Jump" then
            lastAnimations.Jump = animationId
            Animate.jump.JumpAnim.AnimationId = "rbxassetid://" .. animationId
        elseif animationType == "Fall" then
            lastAnimations.Fall = animationId
            Animate.fall.FallAnim.AnimationId = "rbxassetid://" .. animationId
        elseif animationType == "Swim" then
            lastAnimations.Swim = animationId
            local swimScript = Animate:FindFirstChild("swim")
            if swimScript then
                swimScript.SwimAnim.AnimationId = "rbxassetid://" .. animationId
            else
                error("Swim script not found in Animate")
            end
        elseif animationType == "SwimIdle" then
            lastAnimations.SwimIdle = animationId
            local swimIdleScript = Animate:FindFirstChild("swimidle")
            if swimIdleScript then
                swimIdleScript.SwimIdleAnim.AnimationId = "rbxassetid://" .. animationId
            else
                error("SwimIdle script not found in Animate")
            end
        elseif animationType == "Climb" then
            lastAnimations.Climb = animationId
            Animate.climb.ClimbAnim.AnimationId = "rbxassetid://" .. animationId
        end
        
        saveLastAnimations()
    end)

    if not success then
        warn("Failed to set " .. animationType .. " animation:", err)
        Notify("Error", animationType .. " failed: " .. tostring(err), 3)
    else
        Notify("Success", animationType .. " applied", 1)
    end

    -- Unfreeze character after setting animation
    task.wait(0.1)
    unfreeze()
end

-- FIXED: Better respawn handler with freeze/unfreeze
local function reapplyAnimationsOnRespawn(character)
    task.wait(1) -- Wait for animate script to load
    
    -- Freeze character first
    freeze()
    task.wait(0.2)
    
    -- Reapply all last saved animations
    if lastAnimations.Idle then 
        setAnimation("Idle", lastAnimations.Idle) 
    end
    if lastAnimations.Walk then 
        setAnimation("Walk", lastAnimations.Walk) 
    end
    if lastAnimations.Run then 
        setAnimation("Run", lastAnimations.Run) 
    end
    if lastAnimations.Jump then 
        setAnimation("Jump", lastAnimations.Jump) 
    end
    if lastAnimations.Fall then 
        setAnimation("Fall", lastAnimations.Fall) 
    end
    if lastAnimations.Climb then 
        setAnimation("Climb", lastAnimations.Climb) 
    end
    if lastAnimations.Swim then 
        setAnimation("Swim", lastAnimations.Swim) 
    end
    if lastAnimations.SwimIdle then 
        setAnimation("SwimIdle", lastAnimations.SwimIdle) 
    end
    
    -- Force unfreeze after all animations are set
    task.wait(0.2)
    unfreeze()
end

-- Populate all animation buttons
local function REFREHSTHEMAINBUTTONS()
    for _, btn in ipairs(buttons) do
        if btn and btn.Parent then btn:Destroy() end
    end
    buttons = {}
    createdSet = {}

    local function addAnimButton(name, animType, id)
        local buttonText = name .. " - " .. animType
        createTheButton(buttonText, function()
            setAnimation(animType, id)
        end)
    end

    local typeOrder = {"Idle", "Walk", "Run", "Jump", "Fall", "Swim", "SwimIdle", "Climb"}
    for _, animType in ipairs(typeOrder) do
        local anims = Animations[animType]
        if anims then
            for name, ids in pairs(anims) do
                addAnimButton(name, animType, ids)
            end
        end
    end
end

-- Add utility buttons
createTheButton("Reset All Animations", function()
    lastAnimations = {}
    saveLastAnimations()
    Notify("Reset", "All animations reset", 1)
end)

createTheButton("Load Saved Animations", function()
    loadLastAnimations()
    if game.Players.LocalPlayer.Character then
        reapplyAnimationsOnRespawn(game.Players.LocalPlayer.Character)
    end
end)

-- Initialize everything
REFREHSTHEMAINBUTTONS()
loadLastAnimations()

-- Set up respawn handler
Players.LocalPlayer.CharacterAdded:Connect(reapplyAnimationsOnRespawn)

-- Square black and white minimized box
local normalSize = getScaledSize(0.3, 0.4)
local normalPosition = UDim2.new(0.5, -normalSize.X.Offset / 2, 0.5, -normalSize.Y.Offset / 2)
local squareSize = 50
local smallerSize = UDim2.new(0, squareSize, 0, squareSize)
local smallerPosition = UDim2.new(0.5, -squareSize/2, 0.5, -squareSize/2)
local isSmall = false
local clickCount = 0

local function handleDoubleClick()
    if isSmall then
        frame.Size = normalSize
        frame.Position = normalPosition
        scrollFrame.Visible = true
        searchBar.Visible = true
        gazeLabel.Visible = true
        gazeLabel.Text = "GAZE"
        frame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
        frame.BorderColor3 = Color3.new(0, 0, 0)
    else
        frame.Size = smallerSize
        frame.Position = smallerPosition
        scrollFrame.Visible = false
        searchBar.Visible = false
        gazeLabel.Visible = false
        frame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
        frame.BorderColor3 = Color3.new(1, 1, 1)
    end
    isSmall = not isSmall
end

frame.MouseButton1Click:Connect(function()
    clickCount += 1
    if clickCount == 1 then
        task.delay(0.3, function()
            clickCount = 0
        end)
    elseif clickCount == 2 then
        handleDoubleClick()
        clickCount = 0
    end
end)

local lt = os.clock() - st
Notify("Loaded", string.format("Gaze Animation GUI in %.2f seconds", lt), 3)
Notify("Fixed", "Freeze system added - animations work instantly", 4)

end)
